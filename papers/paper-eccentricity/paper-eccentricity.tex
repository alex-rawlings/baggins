%% Based on file 'sample631.tex'
%%
%% Modified 2021 March
%%
%% This is a sample manuscript marked up using the
%% AASTeX v6.31 LaTeX 2e macros.
%%
%% AASTeX is now based on Alexey Vikhlinin's emulateapj.cls 
%% (Copyright 2000-2015).  See the classfile for details.

%% AASTeX requires revtex4-1.cls and other external packages such as
%% latexsym, graphicx, amssymb, longtable, and epsf.  Note that as of 
%% Oct 2020, APS now uses revtex4.2e for its journals but remember that 
%% AASTeX v6+ still uses v4.1. All of these external packages should 
%% already be present in the modern TeX distributions but not always.
%% For example, revtex4.1 seems to be missing in the linux version of
%% TexLive 2020. One should be able to get all packages from www.ctan.org.
%% In particular, revtex v4.1 can be found at 
%% https://www.ctan.org/pkg/revtex4-1.

%% The first piece of markup in an AASTeX v6.x document is the \documentclass
%% command. LaTeX will ignore any data that comes before this command. The 
%% documentclass can take an optional argument to modify the output style.
%% The command below calls the preprint style which will produce a tightly 
%% typeset, one-column, single-spaced document.  It is the default and thus
%% does not need to be explicitly stated.
%%
%% using aastex version 6.3
\documentclass[twocolumn]{aastex631}

%% The default is a single spaced, 10 point font, single spaced article.
%% There are 5 other style options available via an optional argument. They
%% can be invoked like this:
%%
%% \documentclass[arguments]{aastex631}
%% 
%% where the layout options are:
%%
%%  twocolumn   : two text columns, 10 point font, single spaced article.
%%                This is the most compact and represent the final published
%%                derived PDF copy of the accepted manuscript from the publisher
%%  manuscript  : one text column, 12 point font, double spaced article.
%%  preprint    : one text column, 12 point font, single spaced article.  
%%  preprint2   : two text columns, 12 point font, single spaced article.
%%  modern      : a stylish, single text column, 12 point font, article with
%% 		  wider left and right margins. This uses the Daniel
%% 		  Foreman-Mackey and David Hogg design.
%%  RNAAS       : Supresses an abstract. Originally for RNAAS manuscripts 
%%                but now that abstracts are required this is obsolete for
%%                AAS Journals. Authors might need it for other reasons. DO NOT
%%                use \begin{abstract} and \end{abstract} with this style.
%%
%% Note that you can submit to the AAS Journals in any of these 6 styles.
%%
%% There are other optional arguments one can invoke to allow other stylistic
%% actions. The available options are:
%%
%%   astrosymb    : Loads Astrosymb font and define \astrocommands. 
%%   tighten      : Makes baselineskip slightly smaller, only works with 
%%                  the twocolumn substyle.
%%   times        : uses times font instead of the default
%%   linenumbers  : turn on lineno package.
%%   trackchanges : required to see the revision mark up and print its output
%%   longauthor   : Do not use the more compressed footnote style (default) for 
%%                  the author/collaboration/affiliations. Instead print all
%%                  affiliation information after each name. Creates a much 
%%                  longer author list but may be desirable for short 
%%                  author papers.
%% twocolappendix : make 2 column appendix.
%%   anonymous    : Do not show the authors, affiliations and acknowledgments 
%%                  for dual anonymous review.
%%
%% these can be used in any combination, e.g.
%%
%% \documentclass[twocolumn,linenumbers,trackchanges]{aastex631}
%%
%% AASTeX v6.* now includes \hyperref support. While we have built in specific
%% defaults into the classfile you can manually override them with the
%% \hypersetup command. For example,
%%
%% \hypersetup{linkcolor=red,citecolor=green,filecolor=cyan,urlcolor=magenta}
%%
%% will change the color of the internal links to red, the links to the
%% bibliography to green, the file links to cyan, and the external links to
%% magenta. Additional information on \hyperref options can be found here:
%% https://www.tug.org/applications/hyperref/manual.html#x1-40003
%%
%% Note that in v6.3 "bookmarks" has been changed to "true" in hyperref
%% to improve the accessibility of the compiled pdf file.
%%
%% If you want to create your own macros, you can do so
%% using \newcommand. Your macros should appear before
%% the \begin{document} command.
%%
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{bm} % italic bold math symbols

\newcommand{\vdag}{(v)^\dagger}
\newcommand\aastex{AAS\TeX}
\newcommand\latex{La\TeX}

\newcommand{\ketju}{\textsc{Ketju}}
\newcommand{\mstar}{\textsc{MSTAR}}
\newcommand{\gadget}{\textsc{Gadget-4}}

\newcommand{\Msun}{\ensuremath{\mathrm{M}_{\sun}}}
\newcommand{\Rvir}{\ensuremath{R_\mathrm{vir}}}

\newcommand{\dd}[1]{\ensuremath{\mathrm{d}#1}}
\newcommand{\dv}[2]{\ensuremath{\frac{\dd{#1}}{\dd{#2}}}}
\newcommand{\vb}[1]{\ensuremath{\bm{#1}}} %vectors

% drafting macros
\newcommand{\drafting}[1]{
{\leavevmode\color[RGB]{224, 77, 24}#1}
}

\newcommand{\phj}[1]{
{\leavevmode\color[RGB]{0,0,255}#1}
}

%% Reintroduced the \received and \accepted commands from AASTeX v5.2
%\received{March 1, 2021}
%\revised{April 1, 2021}
%\accepted{\today}

%% Command to document which AAS Journal the manuscript was submitted to.
%% Adds "Submitted to " the argument.
%\submitjournal{PSJ}

%% For manuscript that include authors in collaborations, AASTeX v6.31
%% builds on the \collaboration command to allow greater freedom to 
%% keep the traditional author+affiliation information but only show
%% subsets. The \collaboration command now must appear AFTER the group
%% of authors in the collaboration and it takes TWO arguments. The last
%% is still the collaboration identifier. The text given in this
%% argument is what will be shown in the manuscript. The first argument
%% is the number of author above the \collaboration command to show with
%% the collaboration text. If there are authors that are not part of any
%% collaboration the \nocollaboration command is used. This command takes
%% one argument which is also the number of authors above to show. A
%% dashed line is shown to indicate no collaboration. This example manuscript
%% shows how these commands work to display specific set of authors 
%% on the front page.
%%
%% For manuscript without any need to use \collaboration the 
%% \AuthorCollaborationLimit command from v6.2 can still be used to 
%% show a subset of authors.
%
%\AuthorCollaborationLimit=2
%
%% will only show Schwarz & Muench on the front page of the manuscript
%% (assuming the \collaboration and \nocollaboration commands are
%% commented out).
%%
%% Note that all of the author will be shown in the published article.
%% This feature is meant to be used prior to acceptance to make the
%% front end of a long author article more manageable. Please do not use
%% this functionality for manuscripts with less than 20 authors. Conversely,
%% please do use this when the number of authors exceeds 40.
%%
%% Use \allauthors at the manuscript end to show the full author list.
%% This command should only be used with \AuthorCollaborationLimit is used.

%% The following command can be used to set the latex table counters.  It
%% is needed in this document because it uses a mix of latex tabular and
%% AASTeX deluxetables.  In general it should not be needed.
%\setcounter{table}{1}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%
%% The following section outlines numerous optional output that
%% can be displayed in the front matter or as running meta-data.
%%
%% If you wish, you may supply running head information, although
%% this information may be modified by the editorial offices.
\shorttitle{Reviving Stochasticity}
\shortauthors{A. Rawlings et al.}
%%
%% You can add a light gray and diagonal water-mark to the first page 
%% with this command:
%% \watermark{text}
%% where "text", e.g. DRAFT, is the text to appear.  If the text is 
%% long you can control the water-mark size with:
%% \setwatermarkfontsize{dimension}
%% where dimension is any recognized LaTeX dimension, e.g. pt, in, etc.
%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\graphicspath{{./}{figures/}}
%% This is the end of the preamble.  Indicate the beginning of the
%% manuscript itself with \begin{document}.

\begin{document}

\title{Reviving stochasticity: uncertainty in SMBH binary eccentricity is unavoidable}

%% LaTeX will automatically break titles if they run longer than
%% one line. However, you may use \\ to force a line break if
%% you desire. In v6.31 you can include a footnote in the title.

%% A significant change from earlier AASTEX versions is in the structure for 
%% calling author and affiliations. The change was necessary to implement 
%% auto-indexing of affiliations which prior was a manual process that could 
%% easily be tedious in large author manuscripts.
%%
%% The \author command is the same as before except it now takes an optional
%% argument which is the 16 digit ORCID. The syntax is:
%% \author[xxxx-xxxx-xxxx-xxxx]{Author Name}
%%
%% This will hyperlink the author name to the author's ORCID page. Note that
%% during compilation, LaTeX will do some limited checking of the format of
%% the ID to make sure it is valid. If the "orcid-ID.png" image file is 
%% present or in the LaTeX pathway, the OrcID icon will appear next to
%% the authors name.
%%
%% Use \affiliation for affiliation information. The old \affil is now aliased
%% to \affiliation. AASTeX v6.31 will automatically index these in the header.
%% When a duplicate is found its index will be the same as its previous entry.
%%
%% Note that \altaffilmark and \altaffiltext have been removed and thus 
%% can not be used to document secondary affiliations. If they are used latex
%% will issue a specific error message and quit. Please use multiple 
%% \affiliation calls for to document more than one affiliation.
%%
%% The new \altaffiliation can be used to indicate some secondary information
%% such as fellowships. This command produces a non-numeric footnote that is
%% set away from the numeric \affiliation footnotes.  NOTE that if an
%% \altaffiliation command is used it must come BEFORE the \affiliation call,
%% right after the \author command, in order to place the footnotes in
%% the proper location.
%%
%% Use \email to set provide email addresses. Each \email will appear on its
%% own line so you can put multiple email address in one \email call. A new
%% \correspondingauthor command is available in V6.31 to identify the
%% corresponding author of the manuscript. It is the author's responsibility
%% to make sure this name is also in the author list.
%%
%% While authors can be grouped inside the same \author and \affiliation
%% commands it is better to have a single author for each. This allows for
%% one to exploit all the new benefits and should make book-keeping easier.
%%
%% If done correctly the peer review system will be able to
%% automatically put the author and affiliation information from the manuscript
%% and save the corresponding author the trouble of entering it by hand.

%\correspondingauthor{August Muench}
%\email{greg.schwarz@aas.org, gus.muench@aas.org}

\author[0000-0003-1807-6321]{Alexander Rawlings}
\affiliation{Department of Physics,
Gustaf H\"allstr\"omin katu 2, FI-00014, University of Helsinki, Finland}

\author[0000-0001-5721-9335]{Matias Mannerkoski}
\affiliation{Department of Physics,
Gustaf H\"allstr\"omin katu 2, FI-00014, University of Helsinki, Finland}

\author[0000-0001-8741-8263]{Peter H. Johansson}
\affiliation{Department of Physics,
Gustaf H\"allstr\"omin katu 2, FI-00014, University of Helsinki, Finland}

\author[0000-0002-7314-2558]{Thorsten Naab}
\affiliation{Max-Planck-Institut f\"ur Astrophysik, Karl-Schwarzchild-Str 1,
D-85748 Garching, Germany}

\correspondingauthor{Alexander Rawlings}
\email{alexander.rawlings@helsinki.fi}

%% Note that the \and command from previous versions of AASTeX is now
%% depreciated in this version as it is no longer necessary. AASTeX 
%% automatically takes care of all commas and "and"s between authors names.

%% AASTeX 6.31 has the new \collaboration and \nocollaboration commands to
%% provide the collaboration status of a group of authors. These commands 
%% can be used either before or after the list of corresponding authors. The
%% argument for \collaboration is the collaboration identifier. Authors are
%% encouraged to surround collaboration identifiers with ()s. The 
%% \nocollaboration command takes no argument and exists to indicate that
%% the nearby authors are not part of surrounding collaborations.

%% Mark off the abstract in the ``abstract'' environment. 
\begin{abstract}
We study supermassive black hole (SMBH) binary eccentricity of equal-mass galaxy mergers in $N$-body simulations with the \ketju{} code, which combines the \gadget{} fast multipole gravity solver with accurate regularized integration and post-Newtonian corrections around SMBHs.
In simulations with realistic, high eccentricity galactic merger orbits, the binary eccentricity is found to be a non-linear function of the deflection angle in the SMBH orbit during the final, nearly radial close encounter between the SMBHs before they form a bound binary.
This mapping between the deflection angle and the binary eccentricity has no apparent resolution dependence in our simulations spanning the resolution range of $1\times10^5$--$8\times10^6$ particles per galaxy.
The mapping is also captured using a simple model with an analytic potential, indicating that it is driven by the interplay between a smooth asymmetric stellar background potential and dynamical friction acting on the SMBHs.
Due to the non-linearity of this mapping, in certain merger configurations small, parsec-scale variations in the merger orbit can result in binary eccentricities varying in nearly the full possible range between $e=0$ and $e=1$.
In idealized simulations, such variations are caused by finite resolution effects,
and convergence of the binary eccentricity can be achieved with increasing resolution.
However, in real galaxies, other mechanisms such as nuclear gas and substructure that perturb the merger orbit are likely to be significant enough for the binary eccentricity to be effectively random.
Our results indicate that the distribution of these effectively random eccentricities can be studied using even moderate resolution simulations.

\end{abstract}

%% Keywords should appear after the \end{abstract} command. 
%% The AAS Journals now uses Unified Astronomy Thesaurus concepts:
%% https://astrothesaurus.org
%% You will be asked to selected these concepts during the submission process
%% but this old "keyword" functionality is maintained in case authors want
%% to include these concepts in their preprints.
%\keywords{Galaxy mergers (608); Supermassive black holes (1663); Eccentricity (441); N-body simulations (1083); }

%% From the front matter, we move on to the body of the paper.
%% Sections are demarcated by \section and \subsection, respectively.
%% Observe the use of the LaTeX \label
%% command after the \subsection to give a symbolic KEY to the
%% subsection for cross-referencing in a \ref command.
%% You can use LaTeX's \ref and \label commands to keep track of
%% cross-references to sections, equations, tables, and figures.
%% That way, if you change the order of any elements, LaTeX will
%% automatically renumber them.
%%
%% We recommend that authors also use the natbib \citep
%% and \citet commands to identify citations.  The citations are
%% tied to the reference list via symbolic KEYs. The KEY corresponds
%% to the KEY in the \bibitem in the reference list below. 


%-------------------------- MAIN TEXT STARTS HERE --------------------------%
% INTRODUCTION
\section{Introduction}
Supermassive black holes (SMBHs) are believed to reside at the centers of all massive galaxies \citep[e.g.][]{kormendy2013}.
In the $\Lambda$CDM model as galaxies grow through gas accretion and mergers \citep[e.g.][]{volonteri2003,naab2017} their SMBHs 
are also expected to interact in a three-phase merger process \citep{begelman1980}.

Firstly, dynamical friction \citep[DF,][]{chandrasekhar1943} acts to bring the SMBHs from kiloparsec-scales down to parsec-scale separations, after which the SMBHs form a bound binary with a semimajor axis $a$ and eccentricity $e$ \citep[e.g.][]{milosavljevic2001,merritt2013}. In the second phase, the
SMBH binary separation is reduced through sequential slingshot encounters with the surrounding stellar
distribution \citep{hills1980, hills1983, quinlan1996,rantala2018}. Finally, at small subparsec separations gravitational wave (GW) emission
becomes the dominant mechanism by which the SMBH binary can lose its remaining orbital energy and angular momentum, thus driving the
SMBHs to coalescence, where the strength of the GW emission strongly depends on the
binary eccentricity \citep{peters1963,peters1964,mannerkoski2019}.

The complex nature of SMBH coalescence in a galaxy merger setting necessitates the use of numerical techniques \citep[e.g.][]{berentzen2009,khan2011,dosopoulou2017,mannerkoski2019}
to provide quantitative predictions for ongoing observational programs such as ground-based pulsar timing arrays \citep[PTAs,][]{agazie2023,2023Antoniadis,2023Xu,zic2023}
and the upcoming Laser Interferometer Space Antenna \citep[LISA, e.g.][]{amaro-seoane2023}.
Understanding how faithfully SMBH binary eccentricity is captured in numerical simulations is thus critical in constraining the SMBH merger rate
that the observational GW community aims to detect. 

The SMBH binary merging process and its dependence on eccentricity and resolution has been extensively studied using collisionsless merger simulations \citep[e.g.][]{berentzen2009,vasiliev2015,bortolas2016,gualandris2017,gualandris2022}. 
Recently, \citet{nasim2020} have argued that the substantial scatter in SMBH binary eccentricity observed in gas-free merger simulations is an artefact of poor phase space
discretization, and that in the real Universe where SMBH masses are far greater than stellar masses $(M_\bullet \gg m_\star)$, SMBH binary eccentricity is a reliably predictable quantity.   

In this Letter, we find that for realistic galaxy merger orbits the scatter in the final SMBH binary eccentricity is due to the 
physical sensitivity of the final eccentricity to small perturbations of the final  nearly radial plunging trajectory of the SMBHs before they become bound, even in the infinite resolution limit.
As a result, we argue that the stochasticity of the binary eccentricity is an unavoidable physical feature of realistic galaxy mergers, at least in the equal-mass case.

\begin{figure*}
    \centering
    \includegraphics{eccentricities.pdf}
    \caption{Binary eccentricity $e$ (note the non-linear scale) and shifted time $t'=t-t_\mathrm{bound}$ for the $M_\bullet/m_\star=5000$ resolution simulations from the $e_0 = 0.90$ set (blue lines) and $e_0 = 0.99$ set (orange lines). 
    The downwards-pointing arrows indicate the median time when the SMBH binaries becomes hard. 
    In the $e_0=0.90$ set, six simulations have a binary merger within $50\,\mathrm{Myr}$.}
    \label{fig:eccentricities}
\end{figure*}

% NUMERICAL
\section{Numerical Simulations}

We construct a number of idealized galaxy merger simulations, which we evolve with our new version of the \ketju{} code \citep{mannerkoski2023,rantala2017}.
The dynamics of
SMBHs, and stars in a small region around them, are integrated with an algorithmically regularized integrator \citep{rantala2020}, whereas the dynamics of the remaining particles
is computed with the \gadget{} \citep{springel2021} fast multiple method (FMM) with second order multipoles. Together with hierarchical time integration this allows for
symmetric interactions and manifest momentum conservation. \ketju{} also includes post-Newtonian (PN) correction terms up to order 3.5 between each pair of SMBHs \citep{blanchet2014}. 


Our galaxy models represent the nuclear bulge of a gas-devoid elliptical galaxy, matching the models of \citet{nasim2020}.
Each galaxy consists of a stellar-only \citet{dehnen1993} sphere with shape parameter $\gamma=0.5$ and scale radius $a=186\,\mathrm{pc}$, where the Dehnen profile is given by:
\begin{equation}\label{eq:dehnen}
    \rho_\star(r) = \frac{(3-\gamma)M_\star}{4\pi} \frac{a}{r^\gamma (r+a)^{(4-\gamma)}}.
\end{equation}
The total stellar mass is $M_\star=10^{10}\,\Msun$, and at the center of the model galaxy a SMBH of mass $M_\bullet=10^8\,\Msun$ is placed.
We test seven different mass resolutions 
with a varying number of stellar particles: $N_\star = \{1.0\times10^5,2.5\times10^5, 5.0\times10^5, 1.0\times10^6, 2.0\times10^6, 4.0\times10^6, 8.0\times10^6\}$, corresponding to $M_\bullet/m_\star= 1000 \textnormal{--} 80000$.

We then construct isolated merger initial conditions by placing two galaxies on two different elliptical orbits with eccentricities of $e_0=0.90$ and $e_0=0.99$, at a fixed
initial separation of $D=3.72\,\mathrm{kpc}$ and a semimajor axis of $a_0=2.79\,\mathrm{kpc}$.
The $e_0=0.90$ merger orbit matches that used by \citet{nasim2020}, with the radial and tangential velocities being consistent with the values reported in \citet{gualandris2022}.
For each orbital configuration, we run ten realizations for each mass resolution, to account for stochasticity caused by the discretized phase space. 
Interactions between stellar particles are softened with a softening length of $\varepsilon = 2.5\,\mathrm{pc}$, and the \ketju{} region radius is $r_{\rm ketju}=3\varepsilon = 7.5\,\mathrm{pc}$.



% RESULTS
\section{Results}\label{sec:results}

\begin{figure}
    \includegraphics{convergence}
    \caption{Convergence of the eccentricity scatter $\sigma_e$ as a function of mass resolution $M_\bullet/m_\star$ and the total number of stellar particles $N_{\star, \mathrm{tot}}$. 
    The expected $1/\sqrt{N_\star}$ scaling is recovered for the $e_0 = 0.90$ mergers. 
    For the $e_0=0.99$ mergers, $\sigma_e$ does not decrease until $M_\bullet/m_\star \geq 20000$.}
    \label{fig:convergence}
\end{figure}


\subsection{Eccentricity scatter in simulations}

The SMBH binary eccentricity for both the $e_0=0.90$ (blue) and $e_0=0.99$ (orange) orbits are shown in \autoref{fig:eccentricities} as a function of shifted time $t' = t - t_\mathrm{bound}$, where $t_\mathrm{bound}$ is the time when the binary orbital energy $E$ becomes permanently negative. 
The median time when each simulation set forms a hard binary is similar between the two sets, as indicated by the arrows in \autoref{fig:eccentricities}.
The $e_0=0.90$ set also demonstrates six SMBH-binary mergers within $50\,\mathrm{Myr}$ of forming a bound binary, seen as a rapid orbit circularization in \autoref{fig:eccentricities}, which is captured self-consistently using \ketju{}.
The $e_0=0.99$ runs show a wide variation in eccentricity, where $e$ spans almost the entire domain range $e=[0,1]$.
Even though the $e_0=0.99$ runs have a higher initial merger eccentricity than the $e_0=0.90$ runs, none of the SMBH binaries in the shown $e_0=0.99$ set obtain high enough eccentricities to undergo GW-induced coalescence during the $50\,\mathrm{Myr}$ timespan.

To characterize the scatter in eccentricity, we determine the mean eccentricity $e_\mathrm{h}$ over five orbital periods centered on the orbit within which the SMBH binary has become hard.
The binary hardening radius $a_\mathrm{h}$ is defined as \citep[e.g.][]{merritt2006}:
\begin{equation}\label{eq:ahard}
    a_\mathrm{h} = \frac{q}{(1+q)^2} \frac{r_\mathrm{m}}{4} = \frac{r_\mathrm{m}}{16},
\end{equation}
where $r_\mathrm{m}=r(m<2M_{\bullet,1})$ is the influence radius and $q$ is the mass ratio between the SMBHs (for our simulations $q=1.0$). 
We characterize the inter-simulation eccentricity scatter in the mean values of $e_\mathrm{h}$ with the standard deviation, denoted as $\sigma_e$.

We show the dependence of $\sigma_e$ on mass resolution for the $e_0=0.90$ orbit in \autoref{fig:convergence} with blue circle markers, and for the $e_0=0.99$ orbit using orange square markers.

For the $e_0=0.90$ orbit, the convergence of $\sigma_e$ scales as $1/\sqrt{N_{\star,\mathrm{tot}}}$, where $N_{\star,\mathrm{tot}}$ is the total number of stellar particles in the merger.
The values of $\sigma_e$ we report are quantitatively similar to the values found by \citet{nasim2020} for the same system. 
The variation in eccentricity does not show the same scaling for the $e_0=0.99$ orbit as the $e_0=0.90$ orbit. 
For mass resolutions $M_\bullet/m_\star \leq 10000$, the value of $\sigma_e$ is almost constant, before significantly dropping at higher mass resolutions.

\begin{figure*}
    \centering
    \includegraphics{orbit}
    \caption{Orbits from $t=0\,\mathrm{Myr}$ to a time shortly after $t_\mathrm{bound}$ of a single SMBH in two representative realizations of the $e_0=0.90$ mergers (left) and the $e_0=0.99$ mergers (right), which by symmetry of the equal mass system is a reflection of the second BH orbit about $x=-z$. 
    The line gradient shows the shifted time $t'=t-t_\mathrm{bound}$, however the coloring for $|t'|>2\,\mathrm{Myr}$ is constant for visual clarity. 
    In each inset panel, $\theta_\mathrm{defl}$ is the deflection angle at the pericenter between the arrows.
    The circle marker indicates the SMBH position when a bound binary is formed.}
    \label{fig:orbit}
\end{figure*}

\subsection{Binary binding process and the scatter in eccentricity}

To understand the observed scatter in eccentricity, we investigate the binary binding process in each simulation. 
Before the SMBHs are bound, the primary influence on the motion is from the galactic merger potential; two realizations for both merger orbits are shown in \autoref{fig:orbit}.
The initial stages of the orbit show indiscernible variation between realizations, however after a particularly strong interaction between the SMBHs during a pericenter passage, the orbits deviate between realizations (inset panels, \autoref{fig:orbit}), and evolve to different binary eccentricities.

To quantify the strength of the hard-scattering process that randomizes the SMBH orbit, we measure the effective two-body deflection angle, defined as:
\begin{equation}\label{eq:theta}
    \theta_\mathrm{defl} = 2 \arctan \left(\frac{GM}{L\sqrt{2E}} \right) = 2\arctan\left( \frac{b_{90}}{b} \right)
\end{equation}
where $M=M_{\bullet,1}+M_{\bullet,2}$, $L$ is the magnitude of the SMBH 
system angular momentum vector, $E$ the orbital energy at the time of the pericenter passage, $b$ the effective impact parameter, and $b_{90}$ the $90\degr$ deflection radius \citep{binney2008}.

We observe clear evidence for a relationship between the deflection angle $\theta_\mathrm{defl}$ and the resulting eccentricity at the time the SMBH binary becomes hard, as shown with the data points in \autoref{fig:theta_e}.

\begin{figure*}
    \centering
    \includegraphics{theta_e_sim_and_model}
    \caption{
    Deflection angle $\theta_\mathrm{defl}$ and resulting binary eccentricity
    in the $e_0=0.90$ (left) and $e_0=0.99$ (right) simulations,
    compared to fitted model curves.
    The solid lines show the results from the analytic model with $e_\mathrm{s}=0.91$,
    while the semitransparent lines show the results for  $e_\mathrm{s}=0.90$ and $e_\mathrm{s}=0.92$.
    The $e_0=0.90$ model curves have been shifted left by $14\degr$
    to better match the simulation data, with the shift indicated by an arrow.
    The marginal histograms show kernel density estimates of the simulation data.
    The inset panel for the $e_0=0.90$ data shows a zoom-in with $\theta_\mathrm{defl}=[52\degr, 73\degr]$ and $e_\mathrm{h}=[0.96, 1.00]$.
    }
    \label{fig:theta_e}
\end{figure*}


\subsection{Reproducing the eccentricity behavior with a simple model}\label{ssec:toy}

The dependency of the binary eccentricity on the 
deflection angle $\theta_\mathrm{defl}$ during the binary formation
can be reproduced using a simple analytic model,
which includes only the essential components relevant to this process.
Taking the orbit to lie in the $xy$-plane,
the relative motion of the two equal-mass SMBHs in this model follows the 
equation of motion
\begin{equation} \label{eq:toy_model_eom}
\ddot{\vb{x}} = -\frac{2 G M_\bullet}{|\vb{x}|^3} \vb{x} + \vb{a}_\mathrm{bg} + \vb{a}_\mathrm{DF},
\end{equation}
where $\vb{x}=(x,y)$ is the separation vector of the SMBHs,
$M_\bullet = 10^8\,\Msun$ is the mass of a single SMBH,
$\vb{a}_\mathrm{bg}$ the acceleration due to the asymmetric background potential,
and $\vb{a}_\mathrm{DF}$ is the acceleration due to DF.

The stellar background is modeled as a constant density spheroidal potential
\citep[e.g.][]{binney2008}:
\begin{equation}
\Phi_\mathrm{bg}(\vb{x}) = \pi G \rho (A_x x^2 + A_y y^2),
\end{equation}
with the acceleration given by 
\begin{equation}
\vb{a}_\mathrm{bg}(\vb{x}) = - \nabla \Phi_\mathrm{bg}(\vb{x}).
\end{equation}
The $A$ coefficients are related to the eccentricity $e_\mathrm{s}$ of the spheroid as
\begin{align}
A_x &= 2 \left(\frac{1-e_\mathrm{s}^2}{e_\mathrm{s}^2}\right) 
    \left[\frac{1}{2 e_\mathrm{s}} \ln\left(\frac{1+e_\mathrm{s}}{1-e_\mathrm{s}}\right) - 1 \right]\\
A_y &= \frac{1-e_\mathrm{s}^2}{e_\mathrm{s}^2} 
        \left[ \frac{1}{1-e_\mathrm{s}^2} 
        - \frac{1}{2 e_\mathrm{s}} \ln\left(\frac{1+e_\mathrm{s}}{1-e_\mathrm{s}}\right)\right],
\end{align}
with the long axis aligned along the $x$-axis.
The stellar density is set to $\rho = 300 \,\Msun\,\mathrm{pc}^{-3}$,
which approximately matches the values seen in the simulations when the SMBH binary is becoming bound.

\begin{figure*}
    \centering
    \includegraphics{sample_model_orbits}
    \caption{
    Top:
    Sample orbits computed with the analytic model for different background potential eccentricities $e_\mathrm{s}$,
    with otherwise identical initial conditions.
    The dashed lines show the isopotential contours of the model.
    Only the early part of the orbital evolution is shown for clarity.
    Bottom:
    Orbital eccentricity $e$ of the model orbits (note the non-linear scale).
    The vertical line marks the end of the period shown in the top panels. 
    }
    \label{fig:model_orbits}
\end{figure*}

The DF acting on a single BH is modeled using the \citet{chandrasekhar1943} formula assuming
a Maxwellian distribution with a constant velocity dispersion $\sigma_\star$ \citep[e.g.][]{binney2008}:
\begin{equation}\label{eq:chandra_df}
\begin{aligned}
\vb{a}_{1,\mathrm{DF}} = &-\frac{4 \pi G^2 M_\bullet \rho \ln{\Lambda}}{|\vb{v}_{1}|^3}\\
                         &\times\left(\operatorname{erf}(X) - \frac{2X}{\sqrt{\pi}} \exp(-X^2)\right)\vb{v}_{1},
\end{aligned}
\end{equation}
where $\vb{v}_1 = \dot{\vb{x}}/2$ is the velocity of a single BH,
and $X = |\vb{v}_1|/\left(\sqrt{2}\sigma_\star\right)$.
We set ${\sigma_\star=200\,\mathrm{km\,s^{-1}}}$ based on the value measured from the simulations.
The value of the Coulomb logarithm is expected to be in the range $\ln{\Lambda}\sim 4\textnormal{--}5$
based on the size of the stellar system,
and we find that $\ln{\Lambda} = 4.7$ gives results that agree well with the simulations.

The effect of DF weakens as the SMBH binary orbit shrinks.
To account for this, when the binary is bound 
we multiply the acceleration given by equation~\eqref{eq:chandra_df}
with the smooth cut-off function
\begin{equation}
f(a) = \frac{1}{1 + \exp[(a_\mathrm{c}-a)/d_\mathrm{c}]}.
\end{equation}
Here $a$ is the semimajor axis of a bound binary,
and the cut-off scales are $a_\mathrm{c}=2 a_\mathrm{h}$
and $d_\mathrm{c} = 0.5 a_\mathrm{h}$,
with $a_\mathrm{h}$ defined by equation~\eqref{eq:ahard}.
The total DF term is then
\begin{equation}
\vb{a}_{\mathrm{DF}} = 2 f(a) \vb{a}_{1,\mathrm{DF}}.
\end{equation}

To mimic the nearly linearly plunging orbits before the scattering event seen in \autoref{fig:orbit},
we specify the initial conditions as 
\begin{align}
\vb{x}_0 &= (25\,\mathrm{pc}, b)\\
\dot{\vb{x}}_0 &= (-v_0, 0).
\end{align}
In order to match the typical SMBH relative velocity seen at this separation in
the simulations we set $v_0 = 450\,\mathrm{km\,s^{-1}}$ for the $e_0=0.90$ case, and
 $v_0 = 560\,\mathrm{km\,s^{-1}}$ for the the $e_0=0.99$ case.
 
The spheroid eccentricity parameter $e_\mathrm{s}$ is not easily measured from the simulations,
due to the presence of stellar components that remain tightly bound to the SMBHs and obscure the background
potential relevant for the dynamics,
in combination with a constantly evolving potential.
However, only sufficiently large values of $e_\mathrm{s}$ allow for low binary
eccentricities to be produced,
as is shown by \autoref{fig:model_orbits}.
Performing calculations with different values of $e_\mathrm{s}$,
we found a good fit to the simulation results for $e_\mathrm{s}\approx 0.9$.

We compute the resulting eccentricities for a range of impact parameters up to $b=20\,\mathrm{pc}$
for the two initial velocities,
by solving the equation of motion \eqref{eq:toy_model_eom} until the binary has become hard using
the error controlled 8th order Runge--Kutta method DOP853 included in the SciPy library \citep{virtanen2020}.
For reference, the $90\degr$ deflection radii are $b_{90}\approx 5.8\,\mathrm{pc}$ and
$b_{90}\approx 3.3\,\mathrm{pc}$ for the $e_0=0.90$ and $e_0=0.99$ cases, respectively.

The resulting model curves are shown together with the simulation data in \autoref{fig:theta_e}.
To correctly match the data in the $e_0=0.90$ case, the model curve has been shifted to the left by $14\degr$.
This shift is required likely due to the rotation of the stellar component tilting the background potential
relative to the SMBH trajectories in the simulations, with the effect being only evident in the $e_0=0.90$ case
due to the less radial merger orbit.
In the $e_0=0.99$ case we can also see that the simulation data has significant scatter around
the model curve in the $\theta_\mathrm{defl} \gtrsim 120\degr$ region,
although the simple model does appear to capture the mean behavior relatively well, apart from the very largest values of
$\theta_\mathrm{defl}$.
The behaviour of the model in this region is also sensitive to the exact values of $e_\mathrm{s}$
and $\ln{\Lambda}$,
which might also be related to the large scatter seen in the simulation data.

However, in general the behavior of the simulation data is captured well,
with the model correctly producing the two main eccentricity minima,
as well as the $e\approx 1$ region between them.
The minima occur for trajectories where the torque from the background potential together with the DF
causes the SMBHs to loop around into a nearly circular orbit,
while highly eccentric binaries are produced when the binary is trapped into nearly radial oscillations along 
the main axes of the potential, as shown in \autoref{fig:model_orbits}.


% DISCUSSION
\section{Discussion and Conclusions}

We find that the variation in eccentricity $e_\mathrm{h}$ for a given system configuration is tightly correlated with the variation in the deflection angle $\theta_\mathrm{defl}$, independent of the simulation mass resolution.
Together with the simple analytic model that reproduces well the behavior seen in the simulations,
this demonstrates that the sensitivity of the SMBH binary eccentricity to slight changes in the merger orbit is a physical feature of galactic major mergers on highly radial orbits, and not an error caused by insufficient numerical resolution.

As shown by both the simulations and the analytic model, the eccentricity of the SMBH binary can span nearly the full possible range between $e=[0,1]$, depending on comparatively small, parsec-scale differences in the particular realization of the galactic merger orbit. On the other hand, in minor mergers where the stellar background is less asymmetric when the SMBHs become bound,
the scatter in eccentricity is likely to be relatively low even in the case of a radial merger orbit, since the system is less sensitive to the exact value of the deflection angle,
as seen in the $e_\mathrm{s}=0.2$ case in \autoref{fig:model_orbits}.

Lower eccentricity merger orbits can be expected to show less scatter in the binary eccentricity due to the lack of a hard scattering event that is sensitive to slight perturbations in the merger orbit, which was also seen in the study by \citet{gualandris2022}.
However, major mergers are expected to occur on highly radial orbits based on cosmological simulations \citep[e.g.][]{khochfar2006}. In addition, the DF from the dark matter halo would in general drive even lower eccentricity merger orbits to highly radial final plunges when the initial separation of the galaxies is large enough.

The simulation setup used in this work is idealized, and covers only a small part of the parameter space of merger configurations.
However, similar behavior can be expected to occur also in more realistic models,
since the relevant dynamics occurs within a few hundred parsecs from the center of the merged galaxy,
where we do not expect any significant effects from dark matter or the outer parts of the galaxy, which are not included in our present simulations.


The variation of the deflection angle is caused by the random variation of the impact parameter $b$ through equation~\eqref{eq:theta}.
In numerical simulations with a discretized phase space, the primary cause of random variation in $b$ is the Brownian motion of the SMBHs before they form a bound binary \citep{merritt2001,bortolas2016}.
This effect scales as $1/\sqrt{N_{\star,\mathrm{tot}}}$, which can explain the observed scaling of $\sigma_e$ \citep{nasim2020} when the system falls into the region of parameter space where the relation between $e$ and $b$
is approximately linear.
The deviation from this scaling seen in \autoref{fig:convergence} can then be explained by the fact that the eccentricity is not globally a linear function of the impact parameter. 

While the scatter in the impact parameter between different numerical realizations of the same merger is due to relatively low number of particles compared to real galaxies,
we expect that uncertainty of a similar magnitude is also present in real systems due to various mechanisms, such as perturbations from gas and substructure in their stellar environment.
In addition, the SMBHs are also not necesssarily located exactly at the center of mass of the galaxy.
For example, the work by \citet{batcheldor2010} has suggested that the SMBH in M87 may be displaced from the galactic photocenter by up to $\sim7\,\mathrm{pc}$ due to jet acceleration or gravitational recoil kicks. Thus, it is not possible to give an exact prediction for the SMBH binary eccentricity produced by a given merger,
and instead we must focus on predicting the distribution of eccentricities that can be produced by a given merger configuration.

Predicting the eccentricity distribution requires the knowledge of the distribution of impact parameters that can result from essentially identical mergers
as well as the mapping between the impact parameter, or deflection angle, and the final eccentricity.
Since the relation between the impact parameter and the eccentricity does not appear to significantly depend on the resolution,
simulations at moderate mass resolutions of $M_\bullet/m_\star \sim 10^3$ can be used
to map out the relation by performing a large number of merger simulations,
possibly augmented by more sophisticated versions of the analytic model presented here.
The distribution of impact parameters in real systems is however a much more difficult problem to tackle,
since in simulations numerical resolution effects are likely dominant.

In conclusion, we have shown the importance of the deflection angle $\theta_\mathrm{defl}$, and thus the impact parameter $b$, on the resulting hard binary eccentricity $e_\mathrm{h}$. 
By using a simple, resolution-free analytic model of the SMBH scattering process,
we have demonstrated that uncertainty in SMBH binary eccentricity is not caused solely by discretization effects in galaxy merger simulations,
but is rather due to the physical sensitivity of the system to small changes in the merger orbit,
which can be caused by physical mechanisms in addition to numerical discretization effects.
The results presented here justify extending the investigation to more realistic galaxy merger scenarios,
in order to quantify the expected range of hard binary eccentricities, which is critical for predictions for current and future gravitational wave observation missions. 

% FINAL BITS
\begin{acknowledgments} 
\modulolinenumbers[100] 

We thank Shihong Liao, Dimitrios Irodotou, and Francesco Paolo Rizzuto for interesting discussions.
A.R. acknowledges the support by the University of Helsinki Research Foundation.
A.R., M.M. and P.H.J. acknowledge the support
by the European Research Council via ERC Consolidator Grant KETJU (no. 818930) and the support of the Academy of Finland grant 339127.
TN acknowledges support from the Deutsche Forschungsgemeinschaft (DFG, German Research Foundation) under Germanyâ€™s Excellence Strategy - EXC-2094 - 390783311 from the DFG Cluster of Excellence ``ORIGINS''. 

The numerical simulations used computational resources provided by
the CSC -- IT Center for Science, Finland.

We list here the roles and contributions of the authors according to the Contributor Roles Taxonomy (\href{https://credit.niso.org}{CRediT}). 
\textbf{AR}: Conceptualization, Investigation, Formal analysis, Data curation, Writing -- original draft. 
\textbf{MM}: Conceptualization, Formal analysis, Writing -- original draft. 
\textbf{PHJ}: Supervision, Writing -- review \& editing.
\textbf{TN}:  Writing -- review \& editing.
\end{acknowledgments}

\software{
\ketju{} \citep{mannerkoski2023,rantala2017},
\gadget{} \citep{springel2021},
NumPy \citep{harris2020},
SciPy \citep{virtanen2020},
Matplotlib \citep{hunter2007},
pygad \citep{rottgers2020}.
}




%% For this sample we use BibTeX plus aasjournals.bst to generate the
%% the bibliography. The sample631.bib file was populated from ADS. To
%% get the citations to show in the compiled file do the following:
%%
%% pdflatex sample631.tex
%% bibtext sample631
%% pdflatex sample631.tex
%% pdflatex sample631.tex

\bibliography{../ref}{}
\bibliographystyle{aasjournal}

%% This command is needed to show the entire author+affiliation list when
%% the collaboration and author truncation commands are used.  It has to
%% go at the end of the manuscript.
%\allauthors

%% Include this line if you are using the \added, \replaced, \deleted
%% commands to see a summary list of all changes at the end of the article.
%\listofchanges

\end{document}

% End of file `sample631.tex'.
